# Байесовская фильтрация.

Байесовская фильтрация — это метод оценки состояния динамической системы на основе наблюдений, который использует [[Совместная и условная вероятность. Формула Байеса. Пример.|теорему Байеса]]. Этот метод часто применяется в задачах слежения и оценки, таких как [[Фильтр Калмана. Расширенный фильтр Калмана.|фильтрация Калмана]] и [[Фильтр частиц.|фильтрация частиц]]. Рассмотрим основные концепции и формулы Байесовской фильтрации.

### Основные концепции

В Байесовской фильтрации состояние системы в момент времени $t$ обозначается как $x_t$, а наблюдения — как $z_t$. Процесс можно описать двумя основными уравнениями:

1. **Модель перехода:** описывает, как состояние системы изменяется со временем.
   $p(x_t | x_{t-1})$

2. **Модель наблюдения:** описывает, как наблюдения связаны с состоянием системы.
   $p(z_t | x_t)$

### Предсказание

На этапе предсказания вычисляется [[Распределение случайной величины|априорное распределение состояния]] на основе предыдущего состояния:

$p(x_t | z_{1:t-1}) = \int p(x_t | x_{t-1}) p(x_{t-1} | z_{1:t-1}) \, dx_{t-1}$

### Обновление

На этапе обновления это априорное [[Распределение случайной величины|распределение]] комбинируется с новой наблюдаемой информацией для получения апостериорного распределения:

$p(x_t | z_{1:t}) = \dfrac{p(z_t | x_t) p(x_t | z_{1:t-1})}{p(z_t | z_{1:t-1})}$

где нормализующий множитель $p(z_t | z_{1:t-1})$ определяется как:

$p(z_t | z_{1:t-1}) = \int p(z_t | x_t) p(x_t | z_{1:t-1}) \, dx_t$

### Пример: Фильтр Калмана

[[Фильтр Калмана. Расширенный фильтр Калмана.|Фильтр Калмана]] — это специальный случай Байесовской фильтрации для линейных систем с гауссовским шумом. В этом случае все распределения являются гауссовскими, и вычисления могут быть выполнены аналитически. 

1. **Предсказание состояния:**
   
   $\hat{x}_t^- = A \hat{x}_{t-1} + B u_{t-1}$
   
   $P_t^- = A P_{t-1} A^T + Q$

2. **Обновление состояния:**
   
   $K_t = P_t^- H^T (H P_t^- H^T + R)^{-1}$
   
   $\hat{x}_t = \hat{x}_t^- + K_t (z_t - H \hat{x}_t^-)$
   
   $P_t = (I - K_t H) P_t^-$

где $A$ — матрица перехода состояния, $B$ — матрица управления, $u_{t-1}$ — вектор управления, $Q$ — ковариационная матрица шума процесса, $H$ — матрица наблюдения, $R$ — ковариационная матрица шума наблюдений, $\hat{x}_t$ — оценка состояния, $P_t$ — ковариационная матрица ошибки оценки, $K_t$ — матрица Калмана, $z_t$ — наблюдение.

Таким образом, Байесовская фильтрация предоставляет мощный и гибкий способ для оценки состояния системы на основе последовательных наблюдений и применения теоремы Байеса.