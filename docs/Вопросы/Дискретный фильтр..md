---
aliases:
  - фильтр
---

# Дискретный фильтр.

### Дискретный фильтр

Дискретный фильтр используется для оценки состояния системы, описываемой вероятностной моделью, на основе последовательности измерений, подверженных шуму. Это важный инструмент в задачах обработки сигналов и управления, позволяющий отслеживать состояние системы во времени. Одним из наиболее известных дискретных фильтров является [[Фильтр Калмана. Расширенный фильтр Калмана.|фильтр Калмана]].

### Основные компоненты дискретного фильтра

1. **Модель системы**
   - **Динамическая модель**: Описывает, как состояние системы изменяется со временем.
     $x_{k+1} = F_k x_k + B_k u_k + w_k$
     где $x_k$ — состояние системы в момент времени $k$, $F_k$ — матрица перехода, $B_k$ — матрица управления, $u_k$ — вектор управления, $w_k$ — случайный шум процесса с дисперсией $Q_k$.

   - **Модель измерений**: Описывает, как производятся измерения состояния системы.
     $z_k = H_k x_k + v_k$
     где $z_k$ — вектор измерений, $H_k$ — матрица наблюдения, $v_k$ — шум измерения с дисперсией $R_k$.

2. **Процедура предсказания**
   - **Предсказание состояния**: Оценивается состояние системы на основе предыдущей оценки.
     $\hat{x}_{k|k-1} = F_{k-1} \hat{x}_{k-1|k-1} + B_{k-1} u_{k-1}$
   - **Предсказание ошибки [[Ковариация. Матрица ковариаций|ковариации]]**: Оценивается [[Ковариация. Матрица ковариаций|ковариация]] ошибки предсказания.
     $P_{k|k-1} = F_{k-1} P_{k-1|k-1} F_{k-1}^T + Q_{k-1}$

3. **Процедура обновления**
   - **Вычисление калмановского коэффициента усиления**: Определяется вес, с которым новое измерение используется для обновления оценки состояния.
     $K_k = P_{k|k-1} H_k^T (H_k P_{k|k-1} H_k^T + R_k)^{-1}$
   - **Обновление оценки состояния**: Корректируется предсказанная оценка состояния на основе новых измерений.
     $\hat{x}_{k|k} = \hat{x}_{k|k-1} + K_k (z_k - H_k \hat{x}_{k|k-1})$
   - **Обновление ошибки [[Ковариация. Матрица ковариаций|ковариации]]**: Корректируется [[Ковариация. Матрица ковариаций|ковариация]] ошибки оценки.
     $P_{k|k} = (I - K_k H_k) P_{k|k-1}$

### Пример применения дискретного фильтра

Рассмотрим задачу оценки положения объекта, движущегося по прямой, с использованием дискретного фильтра.

**Описание задачи:**
- Объект движется с постоянной скоростью.
- Измерения положения объекта подвержены случайным ошибкам.

**Модель системы:**
- Состояние объекта включает положение и скорость: $x_k = \begin{pmatrix} p_k \\ v_k \end{pmatrix}$.
- Матрица перехода для равномерного движения: $F_k = \begin{pmatrix} 1 & \Delta t \\ 0 & 1 \end{pmatrix}$, где $\Delta t$ — шаг дискретизации.
- Матрица управления: $B_k = 0$ (нет управления).
- Шум процесса: $w_k \sim \mathcal{N}(0, Q_k)$, где $Q_k = \begin{pmatrix} q_{11} & q_{12} \\ q_{21} & q_{22} \end{pmatrix}$.

**Модель измерений:**
- Измеряется только положение объекта: $z_k = p_k + v_k$.
- Матрица наблюдения: $H_k = \begin{pmatrix} 1 & 0 \end{pmatrix}$.
- Шум измерения: $v_k \sim \mathcal{N}(0, R_k)$, где $R_k = r$.

### Реализация фильтра Калмана

1. **Инициализация:**
   - Начальное состояние: $\hat{x}_{0|0} = \begin{pmatrix} p_0 \\ v_0 \end{pmatrix}$.
   - Начальная [[Ковариация. Матрица ковариаций|ковариация]] ошибки: $P_{0|0} = P_0$.

2. **Предсказание:**
   $\hat{x}_{k|k-1} = F_{k-1} \hat{x}_{k-1|k-1}$
   $P_{k|k-1} = F_{k-1} P_{k-1|k-1} F_{k-1}^T + Q_{k-1}$

3. **Обновление:**
   $K_k = P_{k|k-1} H_k^T (H_k P_{k|k-1} H_k^T + R_k)^{-1}$
   $\hat{x}_{k|k} = \hat{x}_{k|k-1} + K_k (z_k - H_k \hat{x}_{k|k-1})$
   $P_{k|k} = (I - K_k H_k) P_{k|k-1}$

### Заключение

Дискретный фильтр, такой как [[Фильтр Калмана. Расширенный фильтр Калмана.|фильтр Калмана]], позволяет эффективно оценивать состояние динамических систем на основе шумных измерений. Он находит широкое применение в задачах навигации, управления, обработки сигналов и других областях, требующих точной оценки состояния систем в реальном времени.